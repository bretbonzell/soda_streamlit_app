test = {'definitionName': 'test_scan', 'defaultDataSource': 'my_datasource_name', 'dataTimestamp': '2024-03-25T19:56:12+00:00',
 'scanStartTimestamp': '2024-03-25T19:56:12+00:00', 'scanEndTimestamp': '2024-03-25T19:56:15+00:00', 'hasErrors': True,
 'hasWarnings': False, 'hasFailures': True, 'metrics': [{'identity': 'metric-test_scan-my_datasource_name-customer-schema',
                                                         'metricName': 'schema', 'dataSourceName': 'my_datasource_name',
                                                         'tableName': 'customer', 'partitionName': None, 'columnName': None, 'value':
                                                             [{'columnName': 'C_CUSTKEY', 'sourceDataType': 'NUMBER'},
                                                              {'columnName': 'C_NAME', 'sourceDataType': 'TEXT'},
                                                              {'columnName': 'C_ADDRESS', 'sourceDataType': 'TEXT'},
                                                              {'columnName': 'C_NATIONKEY', 'sourceDataType': 'NUMBER'},
                                                              {'columnName': 'C_PHONE', 'sourceDataType': 'TEXT'},
                                                              {'columnName': 'C_ACCTBAL', 'sourceDataType': 'NUMBER'},
                                                              {'columnName': 'C_MKTSEGMENT', 'sourceDataType': 'TEXT'},
                                                              {'columnName': 'C_COMMENT', 'sourceDataType': 'TEXT'}]},
                                                        {'identity': 'metric-test_scan-my_datasource_name-customer-C_CUSTKEY-missing_count',
                                                         'metricName': 'missing_count', 'value': 0, 'dataSourceName': 'my_datasource_name'},
                                                        {'identity': 'metric-test_scan-my_datasource_name-customer-row_count',
                                                         'metricName': 'row_count', 'value': 150000,
                                                         'dataSourceName': 'my_datasource_name'}],
 'checks': [{'identity': '0fbaf898', 'name': 'Dataset is unreasonably small', 'type': 'generic', 'definition': 'checks for customer:\n  - row_count < 2:\n      name: Dataset is unreasonably small\n   # Checks that column contains no NULL values\n',
             'resourceAttributes': [], 'location': {'filePath': 'snowflake/checks.yml', 'line': 3, 'col': 8},
             'dataSource': 'my_datasource_name', 'table': 'customer', 'filter': None, 'column': None, 'metrics':
                 ['metric-test_scan-my_datasource_name-customer-row_count'], 'outcome': 'fail',
             'outcomeReasons': [], 'archetype': None, 'diagnostics': {'blocks': [], 'value': 150000,
                                                                      'fail': {'greaterThanOrEqual': 2.0}}},
            {'identity': '3e994c89', 'name': 'No NULL values', 'type': 'generic',
             'definition': 'checks for customer:\n  - missing_count(C_CUSTKEY) = 0:\n      name: No NULL values\n   # Checks for columns removed or added, or changed type or index \n',
             'resourceAttributes': [], 'location': {'filePath': 'snowflake/checks.yml', 'line': 6, 'col': 8},
             'dataSource': 'my_datasource_name', 'table': 'customer', 'filter': None, 'column': 'C_CUSTKEY',
             'metrics': ['metric-test_scan-my_datasource_name-customer-C_CUSTKEY-missing_count'], 'outcome': 'pass', 'outcomeReasons': [], 'archetype': None, 'diagnostics': {'blocks': [], 'value': 0, 'fail': {'greaterThan': 0.0, 'lessThan': 0.0}}}], 'queries': [{'name': 'my_datasource_name.customer.aggregation[0]', 'dataSource': 'my_datasource_name', 'table': 'customer', 'partition': None, 'column': None, 'sql': 'SELECT \n  COUNT(*),\n  COUNT(CASE WHEN C_CUSTKEY IS NULL THEN 1 END) \nFROM sodadata_test.public.customer', 'exception': None, 'duration': '0:00:00.207345'}, {'name': 'my_datasource_name.customer.schema[customer]', 'dataSource': 'my_datasource_name', 'table': 'customer', 'partition': None, 'column': None, 'sql': "SELECT column_name, data_type, is_nullable \nFROM information_schema.columns \nWHERE upper(table_name) = 'CUSTOMER' \n  AND upper(table_catalog) = 'SODADATA_TEST' \n  AND upper(table_schema) = 'PUBLIC'\nORDER BY ORDINAL_POSITION", 'exception': None, 'duration': '0:00:01.424246'}],
 'automatedMonitoringChecks': [], 'profiling': [], 'metadata': [], 'logs': [{'level': 'INFO', 'message': 'Soda Core 3.3.1', 'timestamp': '2024-03-25T19:56:12+00:00', 'index': 1, 'doc': None, 'location': None}, {'level': 'DEBUG', 'message': 'Reading configuration file "snowflake/configuration.yml"', 'timestamp': '2024-03-25T19:56:12+00:00', 'index': 2, 'doc': None, 'location': None}, {'level': 'DEBUG', 'message': 'Reading SodaCL file "snowflake/checks.yml"', 'timestamp': '2024-03-25T19:56:12+00:00', 'index': 3, 'doc': None, 'location': None}, {'level': 'DEBUG', 'message': 'Scan execution starts', 'timestamp': '2024-03-25T19:56:12+00:00', 'index': 4, 'doc': None, 'location': None}, {'level': 'DEBUG', 'message': 'Query my_datasource_name.customer.aggregation[0]:\nSELECT \n  COUNT(*),\n  COUNT(CASE WHEN C_CUSTKEY IS NULL THEN 1 END) \nFROM sodadata_test.public.customer', 'timestamp': '2024-03-25T19:56:13+00:00', 'index': 5, 'doc': None, 'location': None}, {'level': 'DEBUG', 'message': "Query my_datasource_name.customer.schema[customer]:\nSELECT column_name, data_type, is_nullable \nFROM information_schema.columns \nWHERE upper(table_name) = 'CUSTOMER' \n  AND upper(table_catalog) = 'SODADATA_TEST' \n  AND upper(table_schema) = 'PUBLIC'\nORDER BY ORDINAL_POSITION", 'timestamp': '2024-03-25T19:56:13+00:00', 'index': 6, 'doc': None, 'location': None}, {'level': 'ERROR', 'message': 'Soda Core must be configured to connect to Soda Cloud to use change-over-time checks.', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 7, 'doc': None, 'location': None}, {'level': 'WARNING', 'message': 'Skipping schema checks since there is no historic schema metrics!', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 8, 'doc': None, 'location': None}, {'level': 'INFO', 'message': 'Scan summary:', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 9, 'doc': None, 'location': None}, {'level': 'DEBUG', 'message': '2/2 queries OK', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 10, 'doc': None, 'location': None}, {'level': 'DEBUG', 'message': '  my_datasource_name.customer.aggregation[0] [OK] 0:00:00.207345', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 11, 'doc': None, 'location': None}, {'level': 'DEBUG', 'message': '  my_datasource_name.customer.schema[customer] [OK] 0:00:01.424246', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 12, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '1/3 checks PASSED: ', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 13, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '    customer in my_datasource_name', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 14, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '      No NULL values [snowflake/checks.yml] [PASSED]', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 15, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '        check_value: 0', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 16, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '1/3 checks FAILED: ', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 17, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '    customer in my_datasource_name', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 18, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '      Dataset is unreasonably small [snowflake/checks.yml] [FAILED]', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 19, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '        check_value: 150000', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 20, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '1/3 checks NOT EVALUATED: ', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 21, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '    customer in my_datasource_name', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 22, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '      No changes to schema [snowflake/checks.yml] [NOT EVALUATED]', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 23, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '        schema_measured = [C_CUSTKEY NUMBER, C_NAME TEXT, C_ADDRESS TEXT, C_NATIONKEY NUMBER, C_PHONE TEXT, C_ACCTBAL NUMBER, C_MKTSEGMENT TEXT, C_COMMENT TEXT]', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 24, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '1 checks not evaluated.', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 25, 'doc': None, 'location': None}, {'level': 'INFO', 'message': '1 errors.', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 26, 'doc': None, 'location': None}, {'level': 'INFO', 'message': 'Oops! 1 error. 1 failures. 0 warnings. 1 pass.', 'timestamp': '2024-03-25T19:56:15+00:00', 'index': 27, 'doc': None, 'location': None}]}
